{"version":3,"file":"share.js","sources":["../../src/js/components/share.js"],"sourcesContent":["const selectors = {\n  section: 'data-section-type',\n  shareButton: '[data-share-button]',\n  shareMessage: '[data-share-message]',\n};\n\nconst classes = {\n  visible: 'is-visible',\n};\n\nclass ShareButton extends HTMLElement {\n  constructor() {\n    super();\n\n    this.container = this.closest(`[${selectors.section}]`);\n    this.shareButton = this.querySelector(selectors.shareButton);\n    this.shareMessage = this.querySelector(selectors.shareMessage);\n    this.urlToShare = this.shareButton.dataset.shareUrl ? this.shareButton.dataset.shareUrl : document.location.href;\n\n    this.init();\n    this.updateShareLink();\n  }\n\n  init() {\n    if (navigator.share) {\n      this.shareButton.addEventListener('click', () => {\n        navigator.share({url: this.urlToShare, title: document.title});\n      });\n    } else {\n      this.shareButton.addEventListener('click', this.copyToClipboard.bind(this));\n    }\n  }\n\n  updateShareLink() {\n    if (this.container.getAttribute(selectors.section) == 'product') {\n      this.container.addEventListener('theme:variant:change', (event) => {\n        if (event.detail.variant) {\n          this.urlToShare = `${this.urlToShare.split('?')[0]}?variant=${event.detail.variant.id}`;\n        }\n      });\n    }\n  }\n\n  copyToClipboard() {\n    navigator.clipboard.writeText(this.urlToShare).then(() => {\n      this.shareMessage.classList.add(classes.visible);\n\n      const removeVisibleClass = () => {\n        this.shareMessage.classList.remove(classes.visible);\n        this.shareMessage.removeEventListener('animationend', removeVisibleClass);\n      };\n\n      this.shareMessage.addEventListener('animationend', removeVisibleClass);\n    });\n  }\n}\n\nif (!customElements.get('share-button')) {\n  customElements.define('share-button', ShareButton);\n}\n"],"names":["selectors","classes","ShareButton","HTMLElement","constructor","super","this","container","closest","shareButton","querySelector","shareMessage","urlToShare","dataset","shareUrl","document","location","href","init","updateShareLink","navigator","share","addEventListener","url","title","copyToClipboard","bind","getAttribute","event","detail","variant","split","id","clipboard","writeText","then","classList","add","removeVisibleClass","remove","removeEventListener","customElements","get","define"],"mappings":"yBAAA,MAAMA,EACK,oBADLA,EAES,sBAFTA,EAGU,uBAGVC,EACK,aAGX,MAAMC,UAAoBC,YACxBC,cACEC,QAEAC,KAAKC,UAAYD,KAAKE,QAAQ,IAAIR,MAClCM,KAAKG,YAAcH,KAAKI,cAAcV,GACtCM,KAAKK,aAAeL,KAAKI,cAAcV,GACvCM,KAAKM,WAAaN,KAAKG,YAAYI,QAAQC,SAAWR,KAAKG,YAAYI,QAAQC,SAAWC,SAASC,SAASC,KAE5GX,KAAKY,OACLZ,KAAKa,iBACN,CAEDD,OACME,UAAUC,MACZf,KAAKG,YAAYa,iBAAiB,SAAS,KACzCF,UAAUC,MAAM,CAACE,IAAKjB,KAAKM,WAAYY,MAAOT,SAASS,OAAO,IAGhElB,KAAKG,YAAYa,iBAAiB,QAAShB,KAAKmB,gBAAgBC,KAAKpB,MAExE,CAEDa,kBACwD,WAAlDb,KAAKC,UAAUoB,aAAa3B,IAC9BM,KAAKC,UAAUe,iBAAiB,wBAAyBM,IACnDA,EAAMC,OAAOC,UACfxB,KAAKM,WAAa,GAAGN,KAAKM,WAAWmB,MAAM,KAAK,cAAcH,EAAMC,OAAOC,QAAQE,KACpF,GAGN,CAEDP,kBACEL,UAAUa,UAAUC,UAAU5B,KAAKM,YAAYuB,MAAK,KAClD7B,KAAKK,aAAayB,UAAUC,IAAIpC,GAEhC,MAAMqC,EAAqB,KACzBhC,KAAKK,aAAayB,UAAUG,OAAOtC,GACnCK,KAAKK,aAAa6B,oBAAoB,eAAgBF,EAAmB,EAG3EhC,KAAKK,aAAaW,iBAAiB,eAAgBgB,EAAmB,GAEzE,EAGEG,eAAeC,IAAI,iBACtBD,eAAeE,OAAO,eAAgBzC"}