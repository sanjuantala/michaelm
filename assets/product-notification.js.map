{"version":3,"file":"product-notification.js","sources":["../../src/js/components/product-notification.js"],"sourcesContent":["const selectors = {\n  productModal: 'product-modal',\n  close: '[data-popup-close]',\n  notificationForm: '[data-notification-form]',\n  notificationHeading: '[data-product-notification-heading]',\n};\n\nconst classes = {\n  success: 'has-success',\n  hidden: 'hidden',\n};\n\nclass ProductNotification extends HTMLElement {\n  constructor() {\n    super();\n\n    this.notificationForm = this.querySelector(selectors.notificationForm);\n    this.preventSubmit = true;\n    this.popup = this.closest('dialog');\n    this.popupClose = this.popup.querySelector(selectors.close);\n  }\n\n  connectedCallback() {\n    this.checkState();\n\n    this.notificationForm.addEventListener('submit', (e) => this.notificationSubmitEvent(e));\n    this.popupClose.addEventListener('click', () => {\n      this.removeStorage();\n    });\n  }\n\n  checkState() {\n    const notificationFormSuccess = window.location.search.indexOf('?contact_posted=true') !== -1;\n\n    if (notificationFormSuccess) {\n      const productNotificationHeading = this.querySelector(selectors.notificationHeading);\n      productNotificationHeading.classList.add(classes.hidden);\n\n      this.closest(selectors.productModal).classList.add(classes.success);\n      this.popup.removeAttribute('inert');\n\n      if (typeof this.popup.showModal === 'function') {\n        this.popup.showModal();\n      } else {\n        this.popup.setAttribute('open', '');\n      }\n    }\n  }\n\n  notificationSubmitEvent(e) {\n    if (this.preventSubmit) {\n      e.preventDefault();\n\n      this.removeStorage();\n      this.writeStorage();\n      this.preventSubmit = false;\n      this.notificationForm.submit();\n    }\n  }\n\n  writeStorage() {\n    if (window.sessionStorage !== undefined) {\n      window.sessionStorage.setItem('notification_form_id', this.notificationForm.id);\n    }\n  }\n\n  removeStorage() {\n    window.sessionStorage.removeItem('notification_form_id');\n  }\n}\n\nif (!customElements.get('product-notification')) {\n  customElements.define('product-notification', ProductNotification);\n}\n"],"names":["selectors","classes","ProductNotification","HTMLElement","constructor","super","this","notificationForm","querySelector","preventSubmit","popup","closest","popupClose","connectedCallback","checkState","addEventListener","e","notificationSubmitEvent","removeStorage","window","location","search","indexOf","classList","add","removeAttribute","showModal","setAttribute","preventDefault","writeStorage","submit","undefined","sessionStorage","setItem","id","removeItem","customElements","get","define"],"mappings":"yBAAA,MAAMA,EACU,gBADVA,EAEG,qBAFHA,EAGc,2BAHdA,EAIiB,sCAGjBC,EACK,cADLA,EAEI,SAGV,MAAMC,UAA4BC,YAChCC,cACEC,QAEAC,KAAKC,iBAAmBD,KAAKE,cAAcR,GAC3CM,KAAKG,eAAgB,EACrBH,KAAKI,MAAQJ,KAAKK,QAAQ,UAC1BL,KAAKM,WAAaN,KAAKI,MAAMF,cAAcR,EAC5C,CAEDa,oBACEP,KAAKQ,aAELR,KAAKC,iBAAiBQ,iBAAiB,UAAWC,GAAMV,KAAKW,wBAAwBD,KACrFV,KAAKM,WAAWG,iBAAiB,SAAS,KACxCT,KAAKY,eAAe,GAEvB,CAEDJ,aAGE,IAF4F,IAA5DK,OAAOC,SAASC,OAAOC,QAAQ,wBAElC,CACQhB,KAAKE,cAAcR,GAC3BuB,UAAUC,IAAIvB,GAEzCK,KAAKK,QAAQX,GAAwBuB,UAAUC,IAAIvB,GACnDK,KAAKI,MAAMe,gBAAgB,SAES,mBAAzBnB,KAAKI,MAAMgB,UACpBpB,KAAKI,MAAMgB,YAEXpB,KAAKI,MAAMiB,aAAa,OAAQ,GAEnC,CACF,CAEDV,wBAAwBD,GAClBV,KAAKG,gBACPO,EAAEY,iBAEFtB,KAAKY,gBACLZ,KAAKuB,eACLvB,KAAKG,eAAgB,EACrBH,KAAKC,iBAAiBuB,SAEzB,CAEDD,oBACgCE,IAA1BZ,OAAOa,gBACTb,OAAOa,eAAeC,QAAQ,uBAAwB3B,KAAKC,iBAAiB2B,GAE/E,CAEDhB,gBACEC,OAAOa,eAAeG,WAAW,uBAClC,EAGEC,eAAeC,IAAI,yBACtBD,eAAeE,OAAO,uBAAwBpC"}