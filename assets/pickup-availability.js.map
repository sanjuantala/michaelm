{"version":3,"file":"pickup-availability.js","sources":["../../src/js/util/fetch-error.js","../../src/js/vendor/theme-scripts/theme-a11y.js","../../src/js/globals/is-visible.js","../../src/js/globals/animation-end-promise.js","../../src/js/features/popup-actions.js","../../src/js/globals/has-open-modals.js","../../src/js/components/pickup-availability.js"],"sourcesContent":["function FetchError(object) {\n  this.status = object.status || null;\n  this.headers = object.headers || null;\n  this.json = object.json || null;\n  this.body = object.body || null;\n}\nFetchError.prototype = Error.prototype;\n\nexport default FetchError;\n","/**\n * A11y Helpers\n * -----------------------------------------------------------------------------\n * A collection of useful functions that help make your theme more accessible\n */\n\nimport isVisible from '../../globals/is-visible';\n\n/**\n * Moves focus to an HTML element\n * eg for In-page links, after scroll, focus shifts to content area so that\n * next `tab` is where user expects. Used in bindInPageLinks()\n * eg move focus to a modal that is opened. Used in trapFocus()\n *\n * @param {Element} container - Container DOM element to trap focus inside of\n * @param {Object} options - Settings unique to your theme\n * @param {string} options.className - Class name to apply to element on focus.\n */\nexport function forceFocus(element, options) {\n  options = options || {};\n\n  var savedTabIndex = element.tabIndex;\n\n  element.tabIndex = -1;\n  element.dataset.tabIndex = savedTabIndex;\n  element.focus();\n  if (typeof options.className !== 'undefined') {\n    element.classList.add(options.className);\n  }\n  element.addEventListener('blur', callback);\n\n  function callback(event) {\n    event.target.removeEventListener(event.type, callback);\n\n    element.tabIndex = savedTabIndex;\n    delete element.dataset.tabIndex;\n    if (typeof options.className !== 'undefined') {\n      element.classList.remove(options.className);\n    }\n  }\n}\n\n/**\n * If there's a hash in the url, focus the appropriate element\n * This compensates for older browsers that do not move keyboard focus to anchor links.\n * Recommendation: To be called once the page in loaded.\n *\n * @param {Object} options - Settings unique to your theme\n * @param {string} options.className - Class name to apply to element on focus.\n * @param {string} options.ignore - Selector for elements to not include.\n */\n\nexport function focusHash(options) {\n  options = options || {};\n  var hash = window.location.hash;\n  var element = document.getElementById(hash.slice(1));\n\n  // if we are to ignore this element, early return\n  if (element && options.ignore && element.matches(options.ignore)) {\n    return false;\n  }\n\n  if (hash && element) {\n    forceFocus(element, options);\n  }\n}\n\n/**\n * When an in-page (url w/hash) link is clicked, focus the appropriate element\n * This compensates for older browsers that do not move keyboard focus to anchor links.\n * Recommendation: To be called once the page in loaded.\n *\n * @param {Object} options - Settings unique to your theme\n * @param {string} options.className - Class name to apply to element on focus.\n * @param {string} options.ignore - CSS selector for elements to not include.\n */\n\nexport function bindInPageLinks(options) {\n  options = options || {};\n  var links = Array.prototype.slice.call(document.querySelectorAll('a[href^=\"#\"]'));\n\n  function queryCheck(selector) {\n    return document.getElementById(selector) !== null;\n  }\n\n  return links.filter(function (link) {\n    if (link.hash === '#' || link.hash === '') {\n      return false;\n    }\n\n    if (options.ignore && link.matches(options.ignore)) {\n      return false;\n    }\n\n    if (!queryCheck(link.hash.substr(1))) {\n      return false;\n    }\n\n    var element = document.querySelector(link.hash);\n\n    if (!element) {\n      return false;\n    }\n\n    link.addEventListener('click', function () {\n      forceFocus(element, options);\n    });\n\n    return true;\n  });\n}\n\nexport function focusable(container) {\n  var elements = Array.prototype.slice.call(\n    container.querySelectorAll('[tabindex],' + '[draggable],' + 'a[href],' + 'area,' + 'button:enabled,' + 'input:not([type=hidden]):enabled,' + 'object,' + 'select:enabled,' + 'textarea:enabled')\n  );\n\n  // Filter out elements that are not visible.\n  // Copied from jQuery https://github.com/jquery/jquery/blob/2d4f53416e5f74fa98e0c1d66b6f3c285a12f0ce/src/css/hiddenVisibleSelectors.js\n  return elements.filter(function (element) {\n    return !!((element.offsetWidth || element.offsetHeight || element.getClientRects().length) && isVisible(element));\n  });\n}\n\n/**\n * Traps the focus in a particular container\n *\n * @param {Element} container - Container DOM element to trap focus inside of\n * @param {Element} elementToFocus - Element to be focused on first\n * @param {Object} options - Settings unique to your theme\n * @param {string} options.className - Class name to apply to element on focus.\n */\n\nvar trapFocusHandlers = {};\n\nexport function trapFocus(container, options) {\n  options = options || {};\n  var elements = focusable(container);\n  var elementToFocus = options.elementToFocus || container;\n  var first = elements[0];\n  var last = elements[elements.length - 1];\n\n  removeTrapFocus();\n\n  trapFocusHandlers.focusin = function (event) {\n    if (container !== event.target && !container.contains(event.target) && first && first === event.target) {\n      first.focus();\n    }\n\n    if (event.target !== container && event.target !== last && event.target !== first) return;\n    document.addEventListener('keydown', trapFocusHandlers.keydown);\n  };\n\n  trapFocusHandlers.focusout = function () {\n    document.removeEventListener('keydown', trapFocusHandlers.keydown);\n  };\n\n  trapFocusHandlers.keydown = function (event) {\n    if (event.code !== 'Tab') return; // If not TAB key\n\n    // On the last focusable element and tab forward, focus the first element.\n    if (event.target === last && !event.shiftKey) {\n      event.preventDefault();\n      first.focus();\n    }\n\n    //  On the first focusable element and tab backward, focus the last element.\n    if ((event.target === container || event.target === first) && event.shiftKey) {\n      event.preventDefault();\n      last.focus();\n    }\n  };\n\n  document.addEventListener('focusout', trapFocusHandlers.focusout);\n  document.addEventListener('focusin', trapFocusHandlers.focusin);\n\n  forceFocus(elementToFocus, options);\n}\n\n/**\n * Removes the trap of focus from the page\n */\nexport function removeTrapFocus() {\n  document.removeEventListener('focusin', trapFocusHandlers.focusin);\n  document.removeEventListener('focusout', trapFocusHandlers.focusout);\n  document.removeEventListener('keydown', trapFocusHandlers.keydown);\n}\n\n/**\n * Auto focus the last element\n */\nexport function autoFocusLastElement() {\n  if (window.accessibility.lastElement && document.body.classList.contains('is-focused')) {\n    setTimeout(() => {\n      window.accessibility.lastElement?.focus();\n    });\n  }\n}\n\n/**\n * Add a preventive message to external links and links that open to a new window.\n * @param {string} elements - Specific elements to be targeted\n * @param {object} options.messages - Custom messages to overwrite with keys: newWindow, external, newWindowExternal\n * @param {string} options.messages.newWindow - When the link opens in a new window (e.g. target=\"_blank\")\n * @param {string} options.messages.external - When the link is to a different host domain.\n * @param {string} options.messages.newWindowExternal - When the link is to a different host domain and opens in a new window.\n * @param {object} options.prefix - Prefix to namespace \"id\" of the messages\n */\nexport function accessibleLinks(elements, options) {\n  if (typeof elements !== 'string') {\n    throw new TypeError(elements + ' is not a String.');\n  }\n\n  elements = document.querySelectorAll(elements);\n\n  if (elements.length === 0) {\n    return;\n  }\n\n  options = options || {};\n  options.messages = options.messages || {};\n\n  var messages = {\n    newWindow: options.messages.newWindow || 'Opens in a new window.',\n    external: options.messages.external || 'Opens external website.',\n    newWindowExternal: options.messages.newWindowExternal || 'Opens external website in a new window.',\n  };\n\n  var prefix = options.prefix || 'a11y';\n\n  var messageSelectors = {\n    newWindow: prefix + '-new-window-message',\n    external: prefix + '-external-message',\n    newWindowExternal: prefix + '-new-window-external-message',\n  };\n\n  function generateHTML(messages) {\n    var container = document.createElement('ul');\n    var htmlMessages = Object.keys(messages).reduce(function (html, key) {\n      return (html += '<li id=' + messageSelectors[key] + '>' + messages[key] + '</li>');\n    }, '');\n\n    container.setAttribute('hidden', true);\n    container.innerHTML = htmlMessages;\n\n    document.body.appendChild(container);\n  }\n\n  function externalSite(link) {\n    return link.hostname !== window.location.hostname;\n  }\n\n  elements.forEach(function (link) {\n    var target = link.getAttribute('target');\n    var rel = link.getAttribute('rel');\n    var isExternal = externalSite(link);\n    var isTargetBlank = target === '_blank';\n    var missingRelNoopener = rel === null || rel.indexOf('noopener') === -1;\n\n    if (isTargetBlank && missingRelNoopener) {\n      var relValue = rel === null ? 'noopener' : rel + ' noopener';\n      link.setAttribute('rel', relValue);\n    }\n\n    if (isExternal && isTargetBlank) {\n      link.setAttribute('aria-describedby', messageSelectors.newWindowExternal);\n    } else if (isExternal) {\n      link.setAttribute('aria-describedby', messageSelectors.external);\n    } else if (isTargetBlank) {\n      link.setAttribute('aria-describedby', messageSelectors.newWindow);\n    }\n  });\n\n  generateHTML(messages);\n}\n","function isVisible(el) {\n  var style = window.getComputedStyle(el);\n  return style.display !== 'none' && style.visibility !== 'hidden';\n}\n\nexport default isVisible;\n","/*\n  Trigger event after animation completes\n*/\nfunction waitForAnimationEnd(element) {\n  return new Promise((resolve) => {\n    function onAnimationEnd(event) {\n      if (event.target != element) return;\n\n      element.removeEventListener('animationend', onAnimationEnd);\n      resolve();\n    }\n\n    element?.addEventListener('animationend', onAnimationEnd);\n  });\n}\n\nexport default waitForAnimationEnd;\n","import * as a11y from '../vendor/theme-scripts/theme-a11y';\nimport hasOpenModals from '../globals/has-open-modals';\nimport waitForAnimationEnd from '../globals/animation-end-promise';\n\nconst selectors = {\n  open: '[data-popup-open]',\n  close: '[data-popup-close]',\n  focusable: 'button, [href], select, textarea, [tabindex]:not([tabindex=\"-1\"])',\n};\n\nconst attributes = {\n  closing: 'closing',\n};\n\nclass PopupActions {\n  constructor(popup, holder, showModal = true, scrollLock = true) {\n    this.popup = popup;\n    this.holder = holder;\n    this.a11y = a11y;\n    this.isAnimating = false;\n    this.showModal = showModal;\n    this.enableScrollLock = scrollLock;\n    this.buttonPopupOpen = this.holder?.querySelector(selectors.open);\n\n    this.popupEvents();\n  }\n\n  popupOpen() {\n    if (!this.popup) return;\n\n    this.isAnimating = true;\n\n    // Check if browser supports Dialog tags\n    if (this.showModal && typeof this.popup.showModal === 'function') {\n      this.popup.showModal();\n    } else if (!this.showModal && typeof this.popup.show === 'function') {\n      this.popup.show();\n    } else {\n      this.popup.setAttribute('open', '');\n    }\n\n    this.popup.removeAttribute('inert');\n    this.popup.focus(); // Focus <dialog> tag element to prevent immediate closing on Escape keypress\n\n    if (this.enableScrollLock) {\n      document.dispatchEvent(new CustomEvent('theme:scroll:lock', {bubbles: true}));\n    }\n\n    waitForAnimationEnd(this.popup).then(() => {\n      this.isAnimating = false;\n\n      if (this.enableScrollLock) {\n        this.a11y.trapFocus(this.popup);\n      }\n\n      const focusTarget = this.popup.querySelector('[autofocus]') || this.popup.querySelector(selectors.focusable);\n      focusTarget?.focus();\n    });\n  }\n\n  popupClose() {\n    if (this.isAnimating || !this.popup || this.popup.hasAttribute('inert')) {\n      return;\n    }\n\n    if (!this.popup.hasAttribute(attributes.closing)) {\n      this.popup.setAttribute(attributes.closing, '');\n      this.isAnimating = true;\n\n      waitForAnimationEnd(this.popup).then(() => {\n        this.isAnimating = false;\n        this.popupClose();\n      });\n\n      return;\n    }\n\n    // Check if browser supports Dialog tags\n    if (typeof this.popup.close === 'function') {\n      this.popup.close();\n    } else {\n      this.popup.removeAttribute('open');\n    }\n\n    this.popupCloseActions();\n  }\n\n  popupCloseActions() {\n    if (this.popup.hasAttribute('inert')) return;\n\n    this.popup.setAttribute('inert', '');\n    this.popup.removeAttribute(attributes.closing);\n\n    // Unlock scroll if no other popups & modals are open\n    if (!hasOpenModals() && this.enableScrollLock) {\n      document.dispatchEvent(new CustomEvent('theme:scroll:unlock', {bubbles: true}));\n    }\n\n    this.popup.dispatchEvent(new CustomEvent('theme:popup:onclose', {bubbles: false}));\n\n    if (this.enableScrollLock) {\n      this.a11y.removeTrapFocus();\n      this.a11y.autoFocusLastElement();\n    }\n  }\n\n  popupEvents() {\n    if (!this.popup) return;\n\n    // Open button click event\n    this.buttonPopupOpen?.addEventListener('click', (e) => {\n      e.preventDefault();\n      this.popupOpen();\n      window.accessibility.lastElement = this.buttonPopupOpen;\n    });\n\n    // Close button click event\n    const closeButtons = this.popup.querySelectorAll(selectors.close);\n    if (closeButtons.length) {\n      closeButtons.forEach((closeButton) => {\n        closeButton.addEventListener('click', (e) => {\n          e.preventDefault();\n          this.popupClose();\n        });\n      });\n    }\n\n    // Close dialog on click outside content\n    if (this.showModal) {\n      this.popup.addEventListener('click', (event) => {\n        if (event.target.nodeName === 'DIALOG' && event.type === 'click') {\n          this.popupClose();\n        }\n      });\n    }\n\n    // Close dialog on click ESC key pressed\n    this.popup.addEventListener('keydown', (event) => {\n      if (event.code === 'Escape') {\n        event.preventDefault();\n        this.popupClose();\n      }\n    });\n\n    this.popup.addEventListener('close', () => this.popupCloseActions());\n  }\n}\n\nexport {PopupActions};\n","/*\n  Observe whether or not there are open modals that require scroll lock\n*/\n\nfunction hasOpenModals() {\n  const openModals = Boolean(document.querySelectorAll('dialog[open][data-scroll-lock-required]').length);\n  const openDrawers = Boolean(document.querySelectorAll('.drawer.is-open').length);\n\n  return openModals || openDrawers;\n}\n\nexport default hasOpenModals;\n","import FetchError from '../util/fetch-error';\nimport {PopupActions} from '../features/popup-actions';\n\nconst selectors = {\n  pickupContainer: 'data-store-availability-container',\n  shopifySection: '.shopify-section',\n  drawer: '[data-pickup-drawer]',\n  section: '[data-section-type]',\n};\n\nconst classes = {\n  isHidden: 'hidden',\n};\n\nclass PickupAvailability extends HTMLElement {\n  constructor() {\n    super();\n  }\n\n  connectedCallback() {\n    this.container = this.closest(selectors.section);\n    this.drawer = null;\n    this.container.addEventListener('theme:variant:change', (event) => this.fetchPickupAvailability(event));\n    this.fetchPickupAvailability();\n  }\n\n  fetchPickupAvailability(event) {\n    if ((event && !event.detail.variant) || (event && event.detail.variant && !event.detail.variant.available)) {\n      this.classList.add(classes.isHidden);\n      return;\n    }\n\n    const variantID = event && event.detail.variant ? event.detail.variant.id : this.getAttribute(selectors.pickupContainer);\n\n    if (variantID) {\n      this.popupActions = null;\n      fetch(`${window.theme.routes.root}variants/${variantID}/?section_id=api-pickup-availability`)\n        .then(this.handleErrors)\n        .then((response) => response.text())\n        .then((text) => {\n          const pickupAvailabilityHTML = new DOMParser().parseFromString(text, 'text/html').querySelector(selectors.shopifySection).innerHTML;\n          this.innerHTML = pickupAvailabilityHTML;\n\n          this.drawer = this.querySelector(selectors.drawer);\n          if (!this.drawer) {\n            this.classList.add(classes.isHidden);\n            return;\n          }\n\n          this.classList.remove(classes.isHidden);\n\n          this.popupActions = new PopupActions(this.drawer, this, true, true);\n        })\n        .catch((e) => {\n          console.error(e);\n        });\n    }\n  }\n\n  handleErrors(response) {\n    if (!response.ok) {\n      return response.json().then(function (json) {\n        const e = new FetchError({\n          status: response.statusText,\n          headers: response.headers,\n          json: json,\n        });\n        throw e;\n      });\n    }\n    return response;\n  }\n}\n\nif (!customElements.get('pickup-availability')) {\n  customElements.define('pickup-availability', PickupAvailability);\n}\n"],"names":["FetchError","object","this","status","headers","json","body","forceFocus","element","options","savedTabIndex","tabIndex","dataset","focus","className","classList","add","addEventListener","callback","event","target","removeEventListener","type","remove","focusable","container","Array","prototype","slice","call","querySelectorAll","filter","offsetWidth","offsetHeight","getClientRects","length","el","style","window","getComputedStyle","display","visibility","Error","trapFocusHandlers","removeTrapFocus","document","focusin","focusout","keydown","hash","location","getElementById","ignore","matches","link","selector","substr","querySelector","elements","elementToFocus","first","last","contains","code","shiftKey","preventDefault","accessibility","lastElement","setTimeout","TypeError","messages","newWindow","external","newWindowExternal","prefix","messageSelectors","forEach","getAttribute","rel","isExternal","hostname","externalSite","isTargetBlank","missingRelNoopener","indexOf","relValue","setAttribute","createElement","htmlMessages","Object","keys","reduce","html","key","innerHTML","appendChild","generateHTML","waitForAnimationEnd","Promise","resolve","onAnimationEnd","selectors","attributes","PopupActions","constructor","popup","holder","showModal","scrollLock","a11y","isAnimating","enableScrollLock","buttonPopupOpen","popupEvents","popupOpen","show","removeAttribute","dispatchEvent","CustomEvent","bubbles","then","trapFocus","popupClose","hasAttribute","close","popupCloseActions","openModals","Boolean","openDrawers","hasOpenModals","autoFocusLastElement","e","closeButtons","closeButton","nodeName","classes","PickupAvailability","HTMLElement","super","connectedCallback","closest","drawer","fetchPickupAvailability","detail","variant","available","variantID","id","popupActions","fetch","theme","routes","root","handleErrors","response","text","pickupAvailabilityHTML","DOMParser","parseFromString","catch","console","error","ok","statusText","customElements","get","define"],"mappings":"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"}