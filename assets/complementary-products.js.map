{"version":3,"file":"complementary-products.js","sources":["../../src/js/components/complementary-products.js"],"sourcesContent":["const selectors = {\n  complementaryProducts: 'complementary-products',\n  quickAddProduct: 'quick-add-product',\n};\n\nconst classes = {\n  loaded: 'is-loaded',\n};\n\nconst attributes = {\n  url: 'data-url',\n};\n\nclass ComplementaryProducts extends HTMLElement {\n  constructor() {\n    super();\n  }\n\n  connectedCallback() {\n    const handleIntersection = (entries, observer) => {\n      if (!entries[0].isIntersecting) return;\n      observer.unobserve(this);\n\n      if (this.hasAttribute(attributes.url) && this.getAttribute(attributes.url) !== '') {\n        fetch(this.getAttribute(attributes.url))\n          .then((response) => response.text())\n          .then((text) => {\n            const html = document.createElement('div');\n            html.innerHTML = text;\n            const recommendations = html.querySelector(selectors.complementaryProducts);\n\n            if (recommendations && recommendations.innerHTML.trim().length) {\n              this.innerHTML = recommendations.innerHTML;\n            }\n\n            if (html.querySelector(`${selectors.complementaryProducts} ${selectors.quickAddProduct}`)) {\n              this.classList.add(classes.loaded);\n            }\n          })\n          .catch((e) => {\n            console.error(e);\n          });\n      }\n    };\n\n    new IntersectionObserver(handleIntersection.bind(this), {rootMargin: '0px 0px 400px 0px'}).observe(this);\n  }\n}\n\nif (!customElements.get('complementary-products')) {\n  customElements.define('complementary-products', ComplementaryProducts);\n}\n"],"names":["selectors","classes","attributes","ComplementaryProducts","HTMLElement","constructor","super","connectedCallback","IntersectionObserver","entries","observer","isIntersecting","unobserve","this","hasAttribute","getAttribute","fetch","then","response","text","html","document","createElement","innerHTML","recommendations","querySelector","trim","length","classList","add","catch","e","console","error","bind","rootMargin","observe","customElements","get","define"],"mappings":"yBAAA,MAAMA,EACmB,yBADnBA,EAEa,oBAGbC,EACI,YAGJC,EACC,WAGP,MAAMC,UAA8BC,YAClCC,cACEC,OACD,CAEDC,oBA2BE,IAAIC,sBA1BuB,CAACC,EAASC,KAC9BD,EAAQ,GAAGE,iBAChBD,EAASE,UAAUC,MAEfA,KAAKC,aAAaZ,IAAyD,KAAtCW,KAAKE,aAAab,IACzDc,MAAMH,KAAKE,aAAab,IACrBe,MAAMC,GAAaA,EAASC,SAC5BF,MAAME,IACL,MAAMC,EAAOC,SAASC,cAAc,OACpCF,EAAKG,UAAYJ,EACjB,MAAMK,EAAkBJ,EAAKK,cAAczB,GAEvCwB,GAAmBA,EAAgBD,UAAUG,OAAOC,SACtDd,KAAKU,UAAYC,EAAgBD,WAG/BH,EAAKK,cAAc,GAAGzB,KAAmCA,MAC3Da,KAAKe,UAAUC,IAAI5B,EACpB,IAEF6B,OAAOC,IACNC,QAAQC,MAAMF,EAAE,IAErB,GAGyCG,KAAKrB,MAAO,CAACsB,WAAY,sBAAsBC,QAAQvB,KACpG,EAGEwB,eAAeC,IAAI,2BACtBD,eAAeE,OAAO,yBAA0BpC"}