{"version":3,"file":"collection-filters-form.js","sources":["../../src/js/vendor/theme-scripts/theme-a11y.js","../../src/js/globals/is-visible.js","../../src/js/util/media-query.js","../../src/js/globals/height.js","../../src/js/util/scroll-to.js","../../src/js/components/collection-filters-form.js","../../src/js/util/debounce.js"],"sourcesContent":["/**\n * A11y Helpers\n * -----------------------------------------------------------------------------\n * A collection of useful functions that help make your theme more accessible\n */\n\nimport isVisible from '../../globals/is-visible';\n\n/**\n * Moves focus to an HTML element\n * eg for In-page links, after scroll, focus shifts to content area so that\n * next `tab` is where user expects. Used in bindInPageLinks()\n * eg move focus to a modal that is opened. Used in trapFocus()\n *\n * @param {Element} container - Container DOM element to trap focus inside of\n * @param {Object} options - Settings unique to your theme\n * @param {string} options.className - Class name to apply to element on focus.\n */\nexport function forceFocus(element, options) {\n  options = options || {};\n\n  var savedTabIndex = element.tabIndex;\n\n  element.tabIndex = -1;\n  element.dataset.tabIndex = savedTabIndex;\n  element.focus();\n  if (typeof options.className !== 'undefined') {\n    element.classList.add(options.className);\n  }\n  element.addEventListener('blur', callback);\n\n  function callback(event) {\n    event.target.removeEventListener(event.type, callback);\n\n    element.tabIndex = savedTabIndex;\n    delete element.dataset.tabIndex;\n    if (typeof options.className !== 'undefined') {\n      element.classList.remove(options.className);\n    }\n  }\n}\n\n/**\n * If there's a hash in the url, focus the appropriate element\n * This compensates for older browsers that do not move keyboard focus to anchor links.\n * Recommendation: To be called once the page in loaded.\n *\n * @param {Object} options - Settings unique to your theme\n * @param {string} options.className - Class name to apply to element on focus.\n * @param {string} options.ignore - Selector for elements to not include.\n */\n\nexport function focusHash(options) {\n  options = options || {};\n  var hash = window.location.hash;\n  var element = document.getElementById(hash.slice(1));\n\n  // if we are to ignore this element, early return\n  if (element && options.ignore && element.matches(options.ignore)) {\n    return false;\n  }\n\n  if (hash && element) {\n    forceFocus(element, options);\n  }\n}\n\n/**\n * When an in-page (url w/hash) link is clicked, focus the appropriate element\n * This compensates for older browsers that do not move keyboard focus to anchor links.\n * Recommendation: To be called once the page in loaded.\n *\n * @param {Object} options - Settings unique to your theme\n * @param {string} options.className - Class name to apply to element on focus.\n * @param {string} options.ignore - CSS selector for elements to not include.\n */\n\nexport function bindInPageLinks(options) {\n  options = options || {};\n  var links = Array.prototype.slice.call(document.querySelectorAll('a[href^=\"#\"]'));\n\n  function queryCheck(selector) {\n    return document.getElementById(selector) !== null;\n  }\n\n  return links.filter(function (link) {\n    if (link.hash === '#' || link.hash === '') {\n      return false;\n    }\n\n    if (options.ignore && link.matches(options.ignore)) {\n      return false;\n    }\n\n    if (!queryCheck(link.hash.substr(1))) {\n      return false;\n    }\n\n    var element = document.querySelector(link.hash);\n\n    if (!element) {\n      return false;\n    }\n\n    link.addEventListener('click', function () {\n      forceFocus(element, options);\n    });\n\n    return true;\n  });\n}\n\nexport function focusable(container) {\n  var elements = Array.prototype.slice.call(\n    container.querySelectorAll('[tabindex],' + '[draggable],' + 'a[href],' + 'area,' + 'button:enabled,' + 'input:not([type=hidden]):enabled,' + 'object,' + 'select:enabled,' + 'textarea:enabled')\n  );\n\n  // Filter out elements that are not visible.\n  // Copied from jQuery https://github.com/jquery/jquery/blob/2d4f53416e5f74fa98e0c1d66b6f3c285a12f0ce/src/css/hiddenVisibleSelectors.js\n  return elements.filter(function (element) {\n    return !!((element.offsetWidth || element.offsetHeight || element.getClientRects().length) && isVisible(element));\n  });\n}\n\n/**\n * Traps the focus in a particular container\n *\n * @param {Element} container - Container DOM element to trap focus inside of\n * @param {Element} elementToFocus - Element to be focused on first\n * @param {Object} options - Settings unique to your theme\n * @param {string} options.className - Class name to apply to element on focus.\n */\n\nvar trapFocusHandlers = {};\n\nexport function trapFocus(container, options) {\n  options = options || {};\n  var elements = focusable(container);\n  var elementToFocus = options.elementToFocus || container;\n  var first = elements[0];\n  var last = elements[elements.length - 1];\n\n  removeTrapFocus();\n\n  trapFocusHandlers.focusin = function (event) {\n    if (container !== event.target && !container.contains(event.target) && first && first === event.target) {\n      first.focus();\n    }\n\n    if (event.target !== container && event.target !== last && event.target !== first) return;\n    document.addEventListener('keydown', trapFocusHandlers.keydown);\n  };\n\n  trapFocusHandlers.focusout = function () {\n    document.removeEventListener('keydown', trapFocusHandlers.keydown);\n  };\n\n  trapFocusHandlers.keydown = function (event) {\n    if (event.code !== 'Tab') return; // If not TAB key\n\n    // On the last focusable element and tab forward, focus the first element.\n    if (event.target === last && !event.shiftKey) {\n      event.preventDefault();\n      first.focus();\n    }\n\n    //  On the first focusable element and tab backward, focus the last element.\n    if ((event.target === container || event.target === first) && event.shiftKey) {\n      event.preventDefault();\n      last.focus();\n    }\n  };\n\n  document.addEventListener('focusout', trapFocusHandlers.focusout);\n  document.addEventListener('focusin', trapFocusHandlers.focusin);\n\n  forceFocus(elementToFocus, options);\n}\n\n/**\n * Removes the trap of focus from the page\n */\nexport function removeTrapFocus() {\n  document.removeEventListener('focusin', trapFocusHandlers.focusin);\n  document.removeEventListener('focusout', trapFocusHandlers.focusout);\n  document.removeEventListener('keydown', trapFocusHandlers.keydown);\n}\n\n/**\n * Auto focus the last element\n */\nexport function autoFocusLastElement() {\n  if (window.accessibility.lastElement && document.body.classList.contains('is-focused')) {\n    setTimeout(() => {\n      window.accessibility.lastElement?.focus();\n    });\n  }\n}\n\n/**\n * Add a preventive message to external links and links that open to a new window.\n * @param {string} elements - Specific elements to be targeted\n * @param {object} options.messages - Custom messages to overwrite with keys: newWindow, external, newWindowExternal\n * @param {string} options.messages.newWindow - When the link opens in a new window (e.g. target=\"_blank\")\n * @param {string} options.messages.external - When the link is to a different host domain.\n * @param {string} options.messages.newWindowExternal - When the link is to a different host domain and opens in a new window.\n * @param {object} options.prefix - Prefix to namespace \"id\" of the messages\n */\nexport function accessibleLinks(elements, options) {\n  if (typeof elements !== 'string') {\n    throw new TypeError(elements + ' is not a String.');\n  }\n\n  elements = document.querySelectorAll(elements);\n\n  if (elements.length === 0) {\n    return;\n  }\n\n  options = options || {};\n  options.messages = options.messages || {};\n\n  var messages = {\n    newWindow: options.messages.newWindow || 'Opens in a new window.',\n    external: options.messages.external || 'Opens external website.',\n    newWindowExternal: options.messages.newWindowExternal || 'Opens external website in a new window.',\n  };\n\n  var prefix = options.prefix || 'a11y';\n\n  var messageSelectors = {\n    newWindow: prefix + '-new-window-message',\n    external: prefix + '-external-message',\n    newWindowExternal: prefix + '-new-window-external-message',\n  };\n\n  function generateHTML(messages) {\n    var container = document.createElement('ul');\n    var htmlMessages = Object.keys(messages).reduce(function (html, key) {\n      return (html += '<li id=' + messageSelectors[key] + '>' + messages[key] + '</li>');\n    }, '');\n\n    container.setAttribute('hidden', true);\n    container.innerHTML = htmlMessages;\n\n    document.body.appendChild(container);\n  }\n\n  function externalSite(link) {\n    return link.hostname !== window.location.hostname;\n  }\n\n  elements.forEach(function (link) {\n    var target = link.getAttribute('target');\n    var rel = link.getAttribute('rel');\n    var isExternal = externalSite(link);\n    var isTargetBlank = target === '_blank';\n    var missingRelNoopener = rel === null || rel.indexOf('noopener') === -1;\n\n    if (isTargetBlank && missingRelNoopener) {\n      var relValue = rel === null ? 'noopener' : rel + ' noopener';\n      link.setAttribute('rel', relValue);\n    }\n\n    if (isExternal && isTargetBlank) {\n      link.setAttribute('aria-describedby', messageSelectors.newWindowExternal);\n    } else if (isExternal) {\n      link.setAttribute('aria-describedby', messageSelectors.external);\n    } else if (isTargetBlank) {\n      link.setAttribute('aria-describedby', messageSelectors.newWindow);\n    }\n  });\n\n  generateHTML(messages);\n}\n","function isVisible(el) {\n  var style = window.getComputedStyle(el);\n  return style.display !== 'none' && style.visibility !== 'hidden';\n}\n\nexport default isVisible;\n","function getWindowWidth() {\n  return document.documentElement.clientWidth || document.body.clientWidth || window.innerWidth;\n}\n\nfunction getWindowHeight() {\n  return document.documentElement.clientHeight || document.body.clientHeight || window.innerHeight;\n}\n\nfunction isDesktop() {\n  return getWindowWidth() >= window.theme.sizes.small;\n}\n\nfunction isMobile() {\n  return getWindowWidth() < window.theme.sizes.small;\n}\n\nexport {getWindowWidth, getWindowHeight, isMobile, isDesktop};\n","let screenOrientation = getScreenOrientation();\nwindow.initialWindowHeight = Math.min(window.screen.height, window.innerHeight);\n\nfunction readHeights() {\n  const h = {};\n  h.windowHeight = Math.min(window.screen.height, window.innerHeight);\n  h.footerHeight = getHeight('[data-section-type*=\"footer\"]');\n  h.headerHeight = getHeight('[data-header-height]');\n  h.stickyHeaderHeight = document.querySelector('[data-header-sticky]') ? h.headerHeight : 0;\n  h.collectionNavHeight = getHeight('[data-collection-nav]');\n  h.logoHeight = getFooterLogoWithPadding();\n\n  return h;\n}\n\nfunction setVarsOnResize() {\n  document.addEventListener('theme:resize', resizeVars);\n  setVars();\n}\n\nfunction setVars() {\n  const {windowHeight, headerHeight, logoHeight, footerHeight, collectionNavHeight} = readHeights();\n\n  document.documentElement.style.setProperty('--full-height', `${windowHeight}px`);\n  document.documentElement.style.setProperty('--three-quarters', `${windowHeight * (3 / 4)}px`);\n  document.documentElement.style.setProperty('--two-thirds', `${windowHeight * (2 / 3)}px`);\n  document.documentElement.style.setProperty('--one-half', `${windowHeight / 2}px`);\n  document.documentElement.style.setProperty('--one-third', `${windowHeight / 3}px`);\n\n  document.documentElement.style.setProperty('--collection-nav-height', `${collectionNavHeight}px`);\n  document.documentElement.style.setProperty('--header-height', `${headerHeight}px`);\n  document.documentElement.style.setProperty('--footer-height', `${footerHeight}px`);\n  document.documentElement.style.setProperty('--content-full', `${windowHeight - headerHeight - logoHeight / 2}px`);\n  document.documentElement.style.setProperty('--content-min', `${windowHeight - headerHeight - footerHeight}px`);\n\n  if (document.querySelector('[data-tracking-consent].popup-cookies--bottom')) {\n    document.documentElement.style.setProperty('--cookie-bar-height', `${document.querySelector('[data-tracking-consent].popup-cookies--bottom').offsetHeight}px`);\n  }\n}\n\nfunction resizeVars() {\n  // restrict the heights that are changed on resize to avoid iOS jump when URL bar is shown and hidden\n  const {windowHeight, headerHeight, logoHeight, footerHeight, collectionNavHeight} = readHeights();\n  const currentScreenOrientation = getScreenOrientation();\n\n  if (currentScreenOrientation !== screenOrientation || window.innerWidth > window.theme.sizes.mobile) {\n    // Only update the heights on screen orientation change or larger than mobile devices\n    document.documentElement.style.setProperty('--full-height', `${windowHeight}px`);\n    document.documentElement.style.setProperty('--three-quarters', `${windowHeight * (3 / 4)}px`);\n    document.documentElement.style.setProperty('--two-thirds', `${windowHeight * (2 / 3)}px`);\n    document.documentElement.style.setProperty('--one-half', `${windowHeight / 2}px`);\n    document.documentElement.style.setProperty('--one-third', `${windowHeight / 3}px`);\n\n    // Update the screen orientation state\n    screenOrientation = currentScreenOrientation;\n  }\n\n  document.documentElement.style.setProperty('--collection-nav-height', `${collectionNavHeight}px`);\n\n  document.documentElement.style.setProperty('--header-height', `${headerHeight}px`);\n  document.documentElement.style.setProperty('--footer-height', `${footerHeight}px`);\n  document.documentElement.style.setProperty('--content-full', `${windowHeight - headerHeight - logoHeight / 2}px`);\n  document.documentElement.style.setProperty('--content-min', `${windowHeight - headerHeight - footerHeight}px`);\n\n  if (document.querySelector('[data-tracking-consent].popup-cookies--bottom')) {\n    document.documentElement.style.setProperty('--cookie-bar-height', `${document.querySelector('[data-tracking-consent].popup-cookies--bottom').offsetHeight}px`);\n  }\n}\n\nfunction getScreenOrientation() {\n  if (window.matchMedia('(orientation: portrait)').matches) {\n    return 'portrait';\n  }\n\n  if (window.matchMedia('(orientation: landscape)').matches) {\n    return 'landscape';\n  }\n}\n\nfunction getHeight(selector) {\n  const el = document.querySelector(selector);\n  if (el) {\n    return el.offsetHeight;\n  } else {\n    return 0;\n  }\n}\n\nfunction getFooterLogoWithPadding() {\n  const height = getHeight('[data-footer-logo]');\n  if (height > 0) {\n    return height + 20;\n  } else {\n    return 0;\n  }\n}\n\nexport {setVarsOnResize, setVars, readHeights, getScreenOrientation};\n","import {readHeights} from '../globals/height';\n\nconst scrollTo = (elementTop) => {\n  /* Sticky header check */\n  let {stickyHeaderHeight} = readHeights();\n\n  window.scrollTo({\n    top: elementTop + window.scrollY - stickyHeaderHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n};\n\nexport default scrollTo;\n","import * as a11y from '../vendor/theme-scripts/theme-a11y';\nimport debounce from '../util/debounce';\nimport {isMobile} from '../util/media-query';\nimport scrollTo from '../util/scroll-to';\n\nconst selectors = {\n  section: '[data-section-type]',\n  collectionSidebar: '[data-collection-sidebar]',\n  collectionSidebarSlideOut: '[data-collection-sidebar-slide-out]',\n  collectionSidebarCloseButton: '[data-collection-sidebar-close]',\n  form: '[data-collection-filters-form]',\n  input: 'input',\n  select: 'select',\n  label: 'label',\n  textarea: 'textarea',\n  priceMin: '[data-field-price-min]',\n  priceMax: '[data-field-price-max]',\n  priceMinValue: 'data-field-price-min',\n  priceMaxValue: 'data-field-price-max',\n  rangeMin: '[data-se-min-value]',\n  rangeMax: '[data-se-max-value]',\n  rangeMinValue: 'data-se-min-value',\n  rangeMaxValue: 'data-se-max-value',\n  rangeMinDefault: 'data-se-min',\n  rangeMaxDefault: 'data-se-max',\n  showMore: '[data-show-more]',\n  linkHidden: '[data-link-hidden]',\n  collectionNav: '[data-collection-nav]',\n  productsContainer: '[data-products-grid]',\n  activeFilters: '[data-active-filters]',\n  activeFiltersCount: 'data-active-filters-count',\n  filterUpdateUrlButton: '[data-filter-update-url]',\n  dataSort: '[data-sort-enabled]',\n  sortLinks: '[data-sort-link]',\n  sortValue: 'data-value',\n  sortButton: '[data-popout-toggle]',\n  sortButtonText: '[data-sort-button-text]',\n  resultsCount: '[data-results-count]',\n};\n\nconst classes = {\n  hidden: 'hidden',\n  focused: 'is-focused',\n  loading: 'is-loading',\n  active: 'is-active',\n};\n\nclass CollectionFiltersForm extends HTMLElement {\n  constructor() {\n    super();\n\n    this.container = this.closest(selectors.section);\n    this.collectionSidebar = this.container.querySelector(selectors.collectionSidebar);\n    this.collectionSidebarSlideOut = this.container.querySelector(selectors.collectionSidebarSlideOut);\n    this.form = this.querySelector(selectors.form);\n    this.productsContainer = this.container.querySelector(selectors.productsContainer);\n    this.collectionNav = this.container.querySelector(selectors.collectionNav);\n    this.sort = this.container.querySelector(selectors.dataSort);\n    this.sortButton = this.container.querySelector(selectors.sortButton);\n    this.sortLinks = this.container.querySelectorAll(selectors.sortLinks);\n    this.filterUrlButtons = this.container.querySelectorAll(selectors.filterUpdateUrlButton);\n    this.collectionSidebarCloseButtons = this.container.querySelectorAll(selectors.collectionSidebarCloseButton);\n    this.showMoreOptions = this.querySelectorAll(selectors.showMore);\n    this.a11y = a11y;\n\n    this.updatePriceEvent = debounce((e) => this.updatePrice(e), 500);\n    this.updateRangeEvent = (e) => this.updateRange(e);\n    this.showMoreEvent = (e) => this.showMore(e);\n    this.onSortButtonClickEvent = (e) => this.onSortButtonClick(e);\n    this.submitFormEvent = (e) => this.submitForm(e);\n    this.collectionSidebarCloseEvent = (e) => this.collectionSidebarClose(e);\n    this.filterUpdateFromUrlEvent = (e) => this.filterUpdateFromUrl(e);\n  }\n\n  connectedCallback() {\n    if (this.sort && this.sortLinks.length) {\n      this.sortLinks.forEach((link) => {\n        link.addEventListener('click', this.onSortButtonClickEvent);\n      });\n    }\n\n    if (this.collectionSidebar && this.form) {\n      this.collectionSidebar.addEventListener('input', this.updatePriceEvent);\n\n      this.collectionSidebar.addEventListener('theme:range:update', this.updateRangeEvent);\n    }\n\n    if (this.showMoreOptions.length) {\n      // Show more options from the group\n      this.showMoreOptions.forEach((element) => {\n        element.addEventListener('click', this.showMoreEvent);\n      });\n    }\n\n    if (this.collectionSidebar || this.sort) {\n      window.addEventListener('popstate', this.submitFormEvent);\n    }\n\n    if (this.filterUrlButtons.length) {\n      this.filterUrlButtons.forEach((filterUrlButton) => {\n        filterUrlButton.addEventListener('click', this.filterUpdateFromUrlEvent);\n      });\n    }\n\n    if (this.collectionSidebarCloseButtons.length) {\n      this.collectionSidebarCloseButtons.forEach((button) => {\n        button.addEventListener('click', this.collectionSidebarCloseEvent);\n      });\n    }\n  }\n\n  collectionSidebarClose(e) {\n    e.preventDefault();\n    this.container.dispatchEvent(new CustomEvent('theme:filter:close', {bubbles: false}));\n  }\n\n  onSortButtonClick(e) {\n    e.preventDefault();\n\n    if (this.sortButton) {\n      this.sortButton.dispatchEvent(new Event('click'));\n    }\n\n    this.sortActions(e, e.currentTarget);\n  }\n\n  sortActions(e, link, submitForm = true) {\n    const sortButtonText = this.sort.querySelector(selectors.sortButtonText);\n    const sortActive = this.sort.querySelector(`.${classes.active}`);\n\n    if (sortButtonText) {\n      const linkText = link ? link.textContent.trim() : '';\n      sortButtonText.textContent = linkText;\n    }\n\n    if (sortActive) {\n      sortActive.classList.remove(classes.active);\n    }\n\n    this.sort.classList.toggle(classes.active, link);\n\n    if (link) {\n      link.parentElement.classList.add(classes.active);\n\n      if (submitForm) {\n        this.submitForm(e);\n      }\n    }\n  }\n\n  onSortCheck(e) {\n    let link = null;\n    if (window.location.search.includes('sort_by')) {\n      const url = new window.URL(window.location.href);\n      const urlParams = url.searchParams;\n\n      for (const [key, val] of urlParams.entries()) {\n        const linkSort = this.sort.querySelector(`[${selectors.sortValue}=\"${val}\"]`);\n        if (key.includes('sort_by') && linkSort) {\n          link = linkSort;\n          break;\n        }\n      }\n    }\n\n    this.sortActions(e, link, false);\n  }\n\n  showMore(e) {\n    e.preventDefault();\n    const target = e.target.matches(selectors.showMore) ? e.target : e.target.closest(selectors.showMore);\n\n    target.parentElement.classList.add(classes.hidden);\n    target.parentElement.previousElementSibling.querySelectorAll(selectors.linkHidden).forEach((link, index) => {\n      link.classList.remove(classes.hidden);\n      const input = link.querySelector(selectors.input);\n      if (index === 0 && document.body.classList.contains(classes.focused) && input) {\n        if (this.collectionSidebarSlideOut || isMobile()) {\n          this.a11y.removeTrapFocus();\n          this.a11y.trapFocus(this.collectionSidebar, {\n            elementToFocus: input,\n          });\n        } else {\n          input.focus();\n        }\n      }\n    });\n  }\n\n  updatePrice(e) {\n    const type = e.type;\n    const target = e.target;\n\n    if (type === selectors.input || type === selectors.select || type === selectors.label || type === selectors.textarea) {\n      if (this.form && typeof this.form.submit === 'function') {\n        const priceMin = this.form.querySelector(selectors.priceMin);\n        const priceMax = this.form.querySelector(selectors.priceMax);\n        if (priceMin && priceMax) {\n          if (target.hasAttribute(selectors.priceMinValue) && !priceMax.value) {\n            priceMax.value = priceMax.placeholder;\n          } else if (target.hasAttribute(selectors.priceMaxValue) && !priceMin.value) {\n            priceMin.value = priceMin.placeholder;\n          }\n        }\n\n        this.submitForm(e);\n      }\n    }\n  }\n\n  updateRange(e) {\n    if (this.form && typeof this.form.submit === 'function') {\n      const rangeMin = this.form.querySelector(selectors.rangeMin);\n      const rangeMax = this.form.querySelector(selectors.rangeMax);\n      const priceMin = this.form.querySelector(selectors.priceMin);\n      const priceMax = this.form.querySelector(selectors.priceMax);\n      const checkElements = rangeMin && rangeMax && priceMin && priceMax;\n\n      if (checkElements && rangeMin.hasAttribute(selectors.rangeMinValue) && rangeMax.hasAttribute(selectors.rangeMaxValue)) {\n        const priceMinValue = parseInt(priceMin.placeholder);\n        const priceMaxValue = parseInt(priceMax.placeholder);\n        const rangeMinValue = parseInt(rangeMin.getAttribute(selectors.rangeMinValue));\n        const rangeMaxValue = parseInt(rangeMax.getAttribute(selectors.rangeMaxValue));\n\n        if (priceMinValue !== rangeMinValue || priceMaxValue !== rangeMaxValue) {\n          priceMin.value = rangeMinValue;\n          priceMax.value = rangeMaxValue;\n\n          this.submitForm(e);\n        }\n      }\n    }\n  }\n\n  filterUpdateFromUrl(e) {\n    e.preventDefault();\n    this.submitForm(e, e.currentTarget.getAttribute('href'));\n  }\n\n  submitForm(e, replaceHref = '') {\n    if (!e || (e && e.type !== 'popstate')) {\n      if (replaceHref === '') {\n        const url = new window.URL(window.location.href);\n        let filterUrl = url.searchParams;\n        const filterUrlEntries = filterUrl;\n        const filterUrlParams = Object.fromEntries(filterUrlEntries);\n        const filterUrlRemoveString = filterUrl.toString();\n\n        if (filterUrlRemoveString.includes('filter.') || filterUrlRemoveString.includes('page=') || filterUrlRemoveString.includes('sort_by=')) {\n          for (const key in filterUrlParams) {\n            if (key.includes('filter.') || key === 'page' || key === 'sort_by') {\n              filterUrl.delete(key);\n            }\n          }\n        }\n\n        if (this.form) {\n          const formData = new FormData(this.form);\n          const formParams = new URLSearchParams(formData);\n          const rangeMin = this.form.querySelector(selectors.rangeMin);\n          const rangeMax = this.form.querySelector(selectors.rangeMax);\n          const rangeMinDefaultValue = rangeMin && rangeMin.hasAttribute(selectors.rangeMinDefault) ? rangeMin.getAttribute(selectors.rangeMinDefault) : '';\n          const rangeMaxDefaultValue = rangeMax && rangeMax.hasAttribute(selectors.rangeMaxDefault) ? rangeMax.getAttribute(selectors.rangeMaxDefault) : '';\n          let priceFilterDefaultCounter = 0;\n\n          for (let [key, val] of formParams.entries()) {\n            if ((key.includes('filter.') && val) || (key.includes('sort_by') && val)) {\n              filterUrl.append(key, val);\n\n              if ((val === rangeMinDefaultValue && key === 'filter.v.price.gte') || (val === rangeMaxDefaultValue && key === 'filter.v.price.lte')) {\n                priceFilterDefaultCounter += 1;\n              }\n            }\n          }\n\n          if (priceFilterDefaultCounter === 2) {\n            filterUrl.delete('filter.v.price.gte');\n            filterUrl.delete('filter.v.price.lte');\n          }\n        }\n\n        const filterUrlString = filterUrl.toString();\n        const filterNewParams = filterUrlString ? `?${filterUrlString}` : location.pathname;\n        window.history.pushState(null, '', filterNewParams);\n      } else {\n        window.history.pushState(null, '', replaceHref);\n      }\n    } else if (this.sort) {\n      this.onSortCheck(e);\n    }\n\n    if (this.productsContainer) {\n      this.productsContainer.classList.add(classes.loading);\n      fetch(`${window.location.pathname}${window.location.search}`)\n        .then((response) => response.text())\n        .then((data) => {\n          const dataHtml = new DOMParser().parseFromString(data, 'text/html');\n\n          // Update results count on search page\n          const resultsCountContainer = this.container.querySelector(selectors.resultsCount);\n          if (resultsCountContainer) {\n            const newResultsCount = dataHtml.querySelector(selectors.resultsCount);\n\n            resultsCountContainer.innerHTML = newResultsCount.innerHTML;\n          }\n\n          this.productsContainer.innerHTML = dataHtml.querySelector(selectors.productsContainer).innerHTML;\n\n          if (this.collectionSidebar) {\n            this.collectionSidebar.innerHTML = dataHtml.querySelector(selectors.collectionSidebar).innerHTML;\n\n            const activeFiltersCountContainer = this.collectionSidebar.querySelector(`[${selectors.activeFiltersCount}]`);\n            const activeFiltersContainer = this.container.querySelectorAll(selectors.activeFilters);\n            if (activeFiltersCountContainer && activeFiltersContainer.length) {\n              const activeFiltersCount = parseInt(activeFiltersCountContainer.getAttribute(selectors.activeFiltersCount));\n\n              activeFiltersContainer.forEach((counter) => {\n                counter.textContent = activeFiltersCount;\n                counter.classList.toggle(classes.hidden, activeFiltersCount < 1);\n              });\n            }\n          }\n\n          if (this.collectionNav) {\n            scrollTo(this.productsContainer.getBoundingClientRect().top - this.collectionNav.offsetHeight);\n          }\n\n          setTimeout(() => {\n            this.productsContainer.classList.remove(classes.loading);\n          }, 500);\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    }\n  }\n\n  disconnectedCallback() {\n    if (this.collectionSidebar && this.form) {\n      this.collectionSidebar.removeEventListener('input', this.updatePriceEvent);\n\n      this.collectionSidebar.removeEventListener('theme:range:update', this.updateRangeEvent);\n    }\n\n    if (this.showMoreOptions.length) {\n      this.showMoreOptions.forEach((element) => {\n        element.removeEventListener('click', this.showMoreEvent);\n      });\n    }\n\n    if (this.sort && this.sortLinks.length) {\n      this.sortLinks.forEach((link) => {\n        link.removeEventListener('click', this.onSortButtonClickEvent);\n      });\n    }\n\n    if (this.collectionSidebar || this.sort) {\n      window.removeEventListener('popstate', this.submitFormEvent);\n    }\n\n    if (this.filterUrlButtons.length) {\n      this.filterUrlButtons.forEach((filterUrlButton) => {\n        filterUrlButton.removeEventListener('click', this.filterUpdateFromUrlEvent);\n      });\n    }\n\n    if (this.collectionSidebarCloseButtons.length) {\n      this.collectionSidebarCloseButtons.forEach((button) => {\n        button.removeEventListener('click', this.collectionSidebarCloseEvent);\n      });\n    }\n  }\n}\n\nif (!customElements.get('collection-filters-form')) {\n  customElements.define('collection-filters-form', CollectionFiltersForm);\n}\n","function debounce(fn, time) {\n  let timeout;\n  return function () {\n    // eslint-disable-next-line prefer-rest-params\n    if (fn) {\n      const functionCall = () => fn.apply(this, arguments);\n      clearTimeout(timeout);\n      timeout = setTimeout(functionCall, time);\n    }\n  };\n}\n\nexport default debounce;\n"],"names":["forceFocus","element","options","savedTabIndex","tabIndex","dataset","focus","className","classList","add","addEventListener","callback","event","target","removeEventListener","type","remove","focusable","container","Array","prototype","slice","call","querySelectorAll","filter","offsetWidth","offsetHeight","getClientRects","length","el","style","window","getComputedStyle","display","visibility","trapFocusHandlers","removeTrapFocus","document","focusin","focusout","keydown","hash","location","getElementById","ignore","matches","link","selector","substr","querySelector","elements","elementToFocus","first","last","contains","code","shiftKey","preventDefault","accessibility","lastElement","body","setTimeout","TypeError","messages","newWindow","external","newWindowExternal","prefix","messageSelectors","forEach","getAttribute","rel","isExternal","hostname","externalSite","isTargetBlank","missingRelNoopener","indexOf","relValue","setAttribute","createElement","htmlMessages","Object","keys","reduce","html","key","innerHTML","appendChild","generateHTML","isMobile","documentElement","clientWidth","innerWidth","theme","sizes","small","readHeights","h","windowHeight","Math","min","screen","height","innerHeight","footerHeight","getHeight","headerHeight","stickyHeaderHeight","collectionNavHeight","logoHeight","getFooterLogoWithPadding","matchMedia","getScreenOrientation","initialWindowHeight","selectors","classes","CollectionFiltersForm","HTMLElement","constructor","super","this","closest","collectionSidebar","collectionSidebarSlideOut","form","productsContainer","collectionNav","sort","sortButton","sortLinks","filterUrlButtons","collectionSidebarCloseButtons","showMoreOptions","a11y","updatePriceEvent","fn","time","timeout","functionCall","apply","arguments","clearTimeout","debounce","e","updatePrice","updateRangeEvent","updateRange","showMoreEvent","showMore","onSortButtonClickEvent","onSortButtonClick","submitFormEvent","submitForm","collectionSidebarCloseEvent","collectionSidebarClose","filterUpdateFromUrlEvent","filterUpdateFromUrl","connectedCallback","filterUrlButton","button","dispatchEvent","CustomEvent","bubbles","Event","sortActions","currentTarget","sortButtonText","sortActive","linkText","textContent","trim","toggle","parentElement","onSortCheck","search","includes","urlParams","URL","href","searchParams","val","entries","linkSort","previousElementSibling","index","input","trapFocus","submit","priceMin","priceMax","hasAttribute","value","placeholder","rangeMin","rangeMax","priceMinValue","parseInt","priceMaxValue","rangeMinValue","rangeMaxValue","replaceHref","filterUrl","filterUrlEntries","filterUrlParams","fromEntries","filterUrlRemoveString","toString","delete","formData","FormData","formParams","URLSearchParams","rangeMinDefaultValue","rangeMaxDefaultValue","priceFilterDefaultCounter","append","filterUrlString","filterNewParams","pathname","history","pushState","fetch","then","response","text","data","dataHtml","DOMParser","parseFromString","resultsCountContainer","newResultsCount","activeFiltersCountContainer","activeFiltersContainer","activeFiltersCount","counter","elementTop","scrollTo","top","scrollY","left","behavior","getBoundingClientRect","catch","error","console","log","disconnectedCallback","customElements","get","define"],"mappings":"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"}